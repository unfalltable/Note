---
title: 场景题
categories: 面试
tags: [面试]
---

- [ ] QQ号如何保证申请不重复
  - 使用类似布隆过滤器的机制实现判断qq是否存在


- [ ] 查询年龄大于16岁，性别为女，注册日期范围为2019年的人数，复合索索引怎么建？

- [ ] 500w多万数据，qps很高的情况下查询慢怎么解决

- [ ] 放redis也依旧很热怎么处理
- [ ] 计算100的阶乘
- [ ] 假设日志文件记录每个接口请求耗时，怎么快速找到接口耗时＞500ms的请求？
- [ ] 做SDK怎么提升性能
- [ ] 为什么分开部署比集中部署更消耗CPU
- [ ] 两个线程交替打印，请保证线程安全
  - 用Semaphore实现，比较好，两个线程都可以正常结束，业务代码比较好写
  - 可以将打印封装为一个对象，内部使用synchronized和wait()方法，通过参数控制交替打印

- [ ] 数据库有1000万数据，Redis只能缓存20w数据，怎么保证Redis中存的都是热点数据
  - 使用allkeys-lru淘汰策略，留下的都是经常访问的热点数据
- [ ] 1~2亿数据如何缓存
  - 需要使用Redis分布式集群
    - 负载均衡策略有
  - 哈希取余分区
  - 哈希环
  - 哈希插槽
- [ ] 某搜索公司每天的用户搜索是海量的，求top100热词
  - hash分流成小文件，各个小文件自身构建大顶堆，拿出各个文件大顶堆堆顶，组成全局大顶堆，弹出堆顶，把堆顶下的再加入全局大顶堆
- [ ] 40亿个无符号整数，找出在0 ~ 2^32^ - 1(4294967295) 范围中没出现的数
  - [ ] 最多使用1GB内存
    - 使用一个  2^32^ / 8大小的  byte数组约500MB
    - 遍历40亿个数，出现的为1，没出现的为0
  - [ ] 最多使用3kb内存，但只要找到一个没出现的数即可
    - 3kb如果用来创建整形数组，最大可以创建768大小的数组
    - 我们创建一个512大小的数组即可
    - 遍历40亿个数，将每个数除于 2^32^ / 512（8388608）
    - 然后将对应的数组下标++，最后不够8388608的区间就是没出现的所在区间
    - 在不够的区间再分成512份继续以上操作
  - [ ] 最多使用有限的变量，找到一个没出现的数
    - 将40亿数据二分，哪边没满  2^32^ / 2 的继续二分
- [ ] 现有1T的数据，内存只有1G，该怎么对他们进行排序
  - 申请1g可以创建的接近2的次方的大根堆，遍历1t的数据，记录小的记录，输出到结果文件上

- [ ] 现有40亿条数据，内存只有1G，找出现次数最多的数
  - 将这40亿条数据用hash算法算出其hash值，然后模上100
  - 将取模后值相等的数放在同一个文件下
  - 再用hash表将这100给文件进行排序找出出现次数最大的数
  - 这样得到100个各个文件出现次数最大的数
  - 再排序这100个数得到出现次数最大的数

- [ ] 1000W数据入库，实时返回成功条数
  - 分片读取到内存，对数据进行检验，利用多线程批量入库
